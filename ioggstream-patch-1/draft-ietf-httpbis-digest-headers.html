<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Digest Headers</title><script>
function anchorRewrite() {
  map = { };
  if (window.location.hash.length >= 1) {
    var fragid = window.location.hash.substr(1);
    if (fragid) {
      if (! document.getElementById(fragid)) {
        var prefix = "rfc.";
        var mapped = map[fragid];
        if (mapped) {
          window.location.hash = mapped;
        } else if (fragid.indexOf("section-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(8);
        } else if (fragid.indexOf("appendix-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(9);
        } else if (fragid.indexOf("s-") == 0) {
          var postfix = fragid.substring(2);
          if (postfix.startsWith("abstract")) {
            window.location.hash = prefix + postfix;
          } else if (postfix.startsWith("note-")) {
            window.location.hash = prefix + "note." + postfix.substring(5);
          } else {
            window.location.hash = prefix + "section." + postfix;
          }
        } else if (fragid.indexOf("p-") == 0) {
          var r = fragid.substring(2);
          var p = r.indexOf("-");
          if (p >= 0) {
            window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
          }
        }
      }
    }  
  }
}
window.addEventListener('hashchange', anchorRewrite);
window.addEventListener('DOMContentLoaded', anchorRewrite);
</script>
<style type="text/css">/*<![CDATA[*/

body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract+p code, #rfc\.abstract+p samp, #rfc\.abstract+p tt {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre, span.tt {
  font-size: 13.5px;
  font-family: Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}

.github-fork-ribbon-wrapper {
  display: none;
}
@media screen and (min-width: 800px) {
  /* "Fork me on GitHub" CSS ribbon based on
   * https://github.com/simonwhitaker/github-fork-ribbon-css
   */
  .github-fork-ribbon {
    position: absolute;
    padding: 2px 0;
    background-color: #a00;
    background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.15));
    box-shadow: 0 2px 3px 0 rgba(0, 0, 0, 0.5);
    font: 700 12px "Helvetica Neue", Helvetica, Arial, sans-serif;

    pointer-events: auto;

    top: 38px;
    right: -45px;

    transform: rotate(45deg);
  }

  .github-fork-ribbon a[href],
  .github-fork-ribbon a[href]:hover {
    color: #fff;
    background-color: transparent;
    text-decoration: none;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.5);
    text-align: center;

    width: 190px;
    line-height: 18px;

    display: inline-block;
    padding: 2px 0;

    border: 1.5px dotted #fff;
    border-color: rgba(255, 255, 255, 0.6);
  }

  .github-fork-ribbon-wrapper {
    display: block;
    width: 130px;
    height: 130px;
    position: absolute;
    overflow: hidden;
    top: 0; right: 0;
    z-index: 2;
    pointer-events: none;
  }
}
@media screen and (min-width: 1000px) {
  .github-fork-ribbon-wrapper {
    position: fixed;
  }
  /*]]>*/</style>
  <meta name="viewport" content="initial-scale=1.0">
<link rel="Contents" href="#rfc.toc"><link rel="Author" href="#rfc.authors"><link rel="License" href="#rfc.copyrightnotice"><link rel="Chapter" title="1 Introduction" href="#rfc.section.1"><link rel="Chapter" title="2 Resource representation and representation-data" href="#rfc.section.2"><link rel="Chapter" title="3 Digest Algorithm values" href="#rfc.section.3"><link rel="Chapter" title="4 Header Field Specifications" href="#rfc.section.4"><link rel="Chapter" title="5 Deprecate Negotiation of Content-MD5" href="#rfc.section.5"><link rel="Chapter" title="6 Broken cryptographic algorithms" href="#rfc.section.6"><link rel="Chapter" title="7 Examples" href="#rfc.section.7"><link rel="Chapter" title="8 Security Considerations" href="#rfc.section.8"><link rel="Chapter" title="9 IANA Considerations" href="#rfc.section.9"><link rel="Chapter" title="10 References" href="#rfc.section.10"><link rel="Appendix" title="A Change Log" href="#rfc.section.A"><link rel="Appendix" title="B FAQ" href="#rfc.section.B"><link rel="Appendix" title="Acknowledgements" href="#rfc.section.unnumbered-1"><meta name="viewport" content="initial-scale=1"><meta name="generator" content="http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.1131, 2019/08/28 11:40:33, XSLT vendor: libxslt http://xmlsoft.org/XSLT/, via: https://github.com/cabo/kramdown-rfc2629 version 1.2.11"><meta name="keywords" content="Digest"><link rel="schema.dcterms" href="http://purl.org/dc/terms/"><meta name="dcterms.creator" content="Polli, R."><meta name="dcterms.creator" content="Pardue, L."><meta name="dcterms.issued" content="2019-08-30"><meta name="dcterms.abstract" content="This document defines the Digest and Want-Digest header fields for HTTP, thus allowing client and server to negotiate an integrity checksum of the exchanged resource representation data.This document obsoletes RFC 3230. It replaces the term “instance” with “representation”, which makes it consistent with the HTTP Semantic and Context defined in RFC 7231."><meta name="description" content="This document defines the Digest and Want-Digest header fields for HTTP, thus allowing client and server to negotiate an integrity checksum of the exchanged resource representation data.This document obsoletes RFC 3230. It replaces the term “instance” with “representation”, which makes it consistent with the HTTP Semantic and Context defined in RFC 7231."></head><body><header><table class="header" id="rfc.headerblock"><tbody><tr><td class="left">HTTP Working Group</td><td class="right">R. Polli</td></tr><tr><td class="left">Internet-Draft</td><td class="right">Team Digitale, Italian Government</td></tr><tr><td class="left">Intended status: Standards Track</td><td class="right">L. Pardue</td></tr><tr><td class="left">Expires: March 2, 2020</td><td class="right">Cloudflare</td></tr><tr><td class="left"></td><td class="right">August 30, 2019</td></tr></tbody></table><div id="rfc.title"><h1>Digest Headers</h1><div class="filename"><a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-digest-headers" class="smpl">draft-ietf-httpbis-digest-headers-latest</a></div></div></header><section id="rfc.abstract"><h2><a href="#rfc.abstract">Abstract</a></h2><div id="rfc.abstract.p.1"><p>This document defines the Digest and Want-Digest header fields for HTTP, thus allowing client and server to negotiate an integrity checksum of the exchanged resource representation data.</p></div><div id="rfc.abstract.p.2"><p>This document obsoletes RFC 3230. It replaces the term “instance” with “representation”, which makes it consistent with the HTTP Semantic and Context defined in RFC 7231.</p></div></section><section id="rfc.note.1" class="note"><h2><a href="#rfc.note.1">Note to Readers</a></h2><div id="rfc.note.1.p.1"><p><em>RFC EDITOR: please remove this section before publication</em></p></div><div id="rfc.note.1.p.2"><p>Discussion of this draft takes place on the HTTP working group mailing list (ietf-http-wg@w3.org), which is archived at <a href="https://lists.w3.org/Archives/Public/ietf-http-wg/">https://lists.w3.org/Archives/Public/ietf-http-wg/</a>.</p></div><div id="rfc.note.1.p.3"><p>The source code and issues list for this draft can be found at <a href="https://github.com/httpwg/http-extensions">https://github.com/httpwg/http-extensions</a>.</p></div></section><section id="rfc.status"><h2><a href="#rfc.status">Status of this Memo</a></h2><div id="rfc.boilerplate.1.p.1"><p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p></div><div id="rfc.boilerplate.1.p.2"><p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF). Note that other groups may also distribute working documents as Internet-Drafts. The list of current Internet-Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.</p></div><div id="rfc.boilerplate.1.p.3"><p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time. It is inappropriate to use Internet-Drafts as reference material or to cite them other than as “work in progress”.</p></div><div id="rfc.boilerplate.1.p.4"><p>This Internet-Draft will expire on March 2, 2020.</p></div></section><section id="rfc.copyrightnotice"><h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2><div id="rfc.boilerplate.2.p.1"><p>Copyright © 2019 IETF Trust and the persons identified as the document authors. All rights reserved.</p></div><div id="rfc.boilerplate.2.p.2"><p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p></div></section><hr class="noprint"><nav id="rfc.toc"><h2 class="np"><a href="#rfc.toc">Table of Contents</a></h2><ul class="toc"><li><a href="#rfc.section.1">1.</a>   <a href="#introduction">Introduction</a><ul><li><a href="#rfc.section.1.1">1.1.</a>   <a href="#brief-history-of-integrity-header-fields">Brief history of integrity header fields</a></li><li><a href="#rfc.section.1.2">1.2.</a>   <a href="#this-proposal">This proposal</a></li><li><a href="#rfc.section.1.3">1.3.</a>   <a href="#goals">Goals</a></li><li><a href="#rfc.section.1.4">1.4.</a>   <a href="#notational-conventions">Notational Conventions</a></li></ul></li><li><a href="#rfc.section.2">2.</a>   <a href="#resource-representation">Resource representation and representation-data</a></li><li><a href="#rfc.section.3">3.</a>   <a href="#algorithms">Digest Algorithm values</a><ul><li><a href="#rfc.section.3.1">3.1.</a>   <a href="#representation-digest">Representation digest</a><ul><li><a href="#rfc.section.3.1.1">3.1.1.</a>   <a href="#digest-algorithm-encoding-examples">digest-algorithm encoding examples</a></li></ul></li></ul></li><li><a href="#rfc.section.4">4.</a>   <a href="#header-field-specifications">Header Field Specifications</a><ul><li><a href="#rfc.section.4.1">4.1.</a>   <a href="#want-digest-header">Want-Digest</a></li><li><a href="#rfc.section.4.2">4.2.</a>   <a href="#digest-header">Digest</a></li></ul></li><li><a href="#rfc.section.5">5.</a>   <a href="#deprecate-negotiation-of-content-md5">Deprecate Negotiation of Content-MD5</a></li><li><a href="#rfc.section.6">6.</a>   <a href="#broken-cryptographic-algorithms">Broken cryptographic algorithms</a></li><li><a href="#rfc.section.7">7.</a>   <a href="#examples">Examples</a><ul><li><a href="#rfc.section.7.1">7.1.</a>   <a href="#unsolicited-digest-response">Unsolicited Digest response</a><ul><li><a href="#rfc.section.7.1.1">7.1.1.</a>   <a href="#representation-data-is-fully-contained-in-the-payload">Representation data is fully contained in the payload</a></li><li><a href="#rfc.section.7.1.2">7.1.2.</a>   <a href="#representation-data-is-not-contained-in-the-payload">Representation data is not contained in the payload</a></li><li><a href="#rfc.section.7.1.3">7.1.3.</a>   <a href="#representation-data-is-partially-contained-in-the-payload-ie-range-request">Representation data is partially contained in the payload i.e. range request</a></li><li><a href="#rfc.section.7.1.4">7.1.4.</a>   <a href="#digest-in-both-request-and-response-returned-value-depends-on-representation-metadata">Digest in both Request and Response. Returned value depends on representation metadata</a></li><li><a href="#rfc.section.7.1.5">7.1.5.</a>   <a href="#digest-in-both-request-and-response-response-uses-id-sha-256">Digest in both Request and Response. Response uses id-sha-256.</a></li></ul></li><li><a href="#rfc.section.7.2">7.2.</a>   <a href="#want-digest-solicited-digest-responses">Want-Digest solicited digest responses</a><ul><li><a href="#rfc.section.7.2.1">7.2.1.</a>   <a href="#client-request-data-is-fully-contained-in-the-payload">Client request data is fully contained in the payload</a></li><li><a href="#rfc.section.7.2.2">7.2.2.</a>   <a href="#a-client-requests-an-unsupported-digest-the-server-may-reply-with-an-unsupported-digest">A client requests an unsupported Digest, the server MAY reply with an unsupported digest</a></li><li><a href="#rfc.section.7.2.3">7.2.3.</a>   <a href="#a-client-requests-an-unsupported-digest-the-server-may-reply-with-a-400">A client requests an unsupported Digest, the server MAY reply with a 400</a></li></ul></li></ul></li><li><a href="#rfc.section.8">8.</a>   <a href="#security-considerations">Security Considerations</a><ul><li><a href="#rfc.section.8.1">8.1.</a>   <a href="#digest-does-not-protect-the-full-http-message">Digest does not protect the full HTTP message</a></li><li><a href="#rfc.section.8.2">8.2.</a>   <a href="#broken-cryptographic-algorithms-1">Broken cryptographic algorithms</a></li><li><a href="#rfc.section.8.3">8.3.</a>   <a href="#digest-for-end-to-end-integrity">Digest for end-to-end integrity</a></li><li><a href="#rfc.section.8.4">8.4.</a>   <a href="#usage-in-signatures">Usage in signatures</a></li><li><a href="#rfc.section.8.5">8.5.</a>   <a href="#message-truncation">Message Truncation</a></li><li><a href="#rfc.section.8.6">8.6.</a>   <a href="#algorithm-agility">Algorithm Agility</a></li></ul></li><li><a href="#rfc.section.9">9.</a>   <a href="#iana-considerations">IANA Considerations</a><ul><li><a href="#rfc.section.9.1">9.1.</a>   <a href="#establish-the-http-digest-algorithm-values">Establish the HTTP Digest Algorithm Values</a></li><li><a href="#rfc.section.9.2">9.2.</a>   <a href="#the-status-field-in-the-http-digest-algorithm-values">The “status” field in the HTTP Digest Algorithm Values</a></li><li><a href="#rfc.section.9.3">9.3.</a>   <a href="#iana-MD5">Deprecate “MD5” Digest Algorithm</a></li><li><a href="#rfc.section.9.4">9.4.</a>   <a href="#iana-SHA">Obsolete “SHA” Digest Algorithm</a></li><li><a href="#rfc.section.9.5">9.5.</a>   <a href="#iana-ID-SHA-256">The “ID-SHA-256” Digest Algorithm</a></li><li><a href="#rfc.section.9.6">9.6.</a>   <a href="#iana-ID-SHA-512">The “ID-SHA-512” Digest Algorithm</a></li><li><a href="#rfc.section.9.7">9.7.</a>   <a href="#changes-compared-to-rfc5843">Changes compared to RFC5843</a></li><li><a href="#rfc.section.9.8">9.8.</a>   <a href="#want-digest-header-field-registration">Want-Digest Header Field Registration</a></li><li><a href="#rfc.section.9.9">9.9.</a>   <a href="#digest-header-field-registration">Digest Header Field Registration</a></li></ul></li><li><a href="#rfc.section.10">10.</a>   <a href="#rfc.references">References</a><ul><li><a href="#rfc.section.10.1">10.1.</a>   <a href="#rfc.references.1">Normative References</a></li><li><a href="#rfc.section.10.2">10.2.</a>   <a href="#rfc.references.2">Informative References</a></li></ul></li><li><a href="#rfc.section.A">Appendix A.</a>   <a href="#change-log">Change Log</a></li><li><a href="#rfc.section.B">Appendix B.</a>   <a href="#faq">FAQ</a></li><li><a href="#acknowledgements">Acknowledgements</a></li><li><a href="#rfc.authors">Authors' Addresses</a></li></ul></nav><section id="introduction"><h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a> <a href="#introduction">Introduction</a></h2><div id="rfc.section.1.p.1"><p>Integrity protection for HTTP content is multi layered and is usually achieved across the protocol stack: TCP checksums and TLS <a href="#RFC2818"><cite title="HTTP Over TLS">[RFC2818]</cite></a> record to name but some.</p></div><div id="rfc.section.1.p.2" class="avoidbreakafter"><p>The HTTP protocol does not provide means to protect the various message parts. Besides, it might be desirable to add additional guarantees to the ones provided by the transport layer (eg. HTTPS). This may be in order to:</p></div><div id="rfc.section.1.p.3"><ul><li>detect programming errors and corruption of stored data;</li><li>address the need for the representation-data to remain unmodified throughout multiple hops;</li><li>implement signature mechanisms that cover the desired parts of an HTTP exchange;</li><li>provide additional protection against failures or attack (see <a href="#SRI"><cite title="Subresource Integrity">[SRI]</cite></a>).</li></ul></div><section id="brief-history-of-integrity-header-fields"><h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> <a href="#brief-history-of-integrity-header-fields">Brief history of integrity header fields</a></h3><div id="rfc.section.1.1.p.1" class="avoidbreakafter"><p>The Content-MD5 header field was originally introduced to provide integrity, but HTTP/1.1 (<a href="#RFC7231"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a>, Appendix B) obsoleted it:</p></div><div id="rfc.section.1.1.p.2"><ul class="empty"><li>The Content-MD5 header field has been removed because it was inconsistently implemented with respect to partial responses.</li></ul></div><div id="rfc.section.1.1.p.3"><p><a href="#RFC3230"><cite title="Instance Digests in HTTP">[RFC3230]</cite></a> provided a more flexible solution introducing the concept of “instance”, and the header fields <span class="tt">Digest</span> and <span class="tt">Want-Digest</span>.</p></div></section><section id="this-proposal"><h3 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a> <a href="#this-proposal">This proposal</a></h3><div id="rfc.section.1.2.p.1"><p>The concept of <span class="tt">selected representation</span> defined in <a href="#RFC7231"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a> made <a href="#RFC3230"><cite title="Instance Digests in HTTP">[RFC3230]</cite></a> definitions inconsistent with the current standard. A refresh was then required.</p></div><div id="rfc.section.1.2.p.2"><p>This document updates the <span class="tt">Digest</span> and <span class="tt">Want-Digest</span> header field definitions to align with <a href="#RFC7231"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a> concepts.</p></div><div id="rfc.section.1.2.p.3"><p>This approach can be easily adapted to use-cases where the transferred data does require some sort of manipulation to be considered a representation or conveys a partial representation of a resource (eg. Range Requests <a href="#RFC7233"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Range Requests">[RFC7233]</cite></a>).</p></div><div id="rfc.section.1.2.p.4"><p>Changes are semantically compatible with existing implementations and better cover both the request and response cases.</p></div><div id="rfc.section.1.2.p.5"><p>The value of <span class="tt">Digest</span> is calculated on selected representation, which is tied to the value contained in any <span class="tt">Content-Encoding</span> or <span class="tt">Content-Type</span> header fields. Therefore, a given resource may have multiple different digest values.</p></div><div id="rfc.section.1.2.p.6"><p>To allow both parties to exchange a Digest of a representation with <a href="https://tools.ietf.org/html/rfc7231#section-3.1.2.1">no content codings</a> two more algorithms are added (<span class="tt">ID-SHA-256</span> and <span class="tt">ID-SHA-512</span>).</p></div></section><section id="goals"><h3 id="rfc.section.1.3"><a href="#rfc.section.1.3">1.3.</a> <a href="#goals">Goals</a></h3><div id="rfc.section.1.3.p.1" class="avoidbreakafter"><p>The goals of this proposal are:</p></div><div id="rfc.section.1.3.p.2"><ol><li>Digest coverage for either the resource’s <span class="tt">representation data</span> or <span class="tt">selected representation data</span> communicated via HTTP.</li><li>Support for multiple digest algorithms.</li><li>Negotiation of the use of digests.</li></ol></div><div id="rfc.section.1.3.p.3" class="avoidbreakafter"><p>The goals do not include:</p></div><div id="rfc.section.1.3.p.4"><dl class="compact"><dt>HTTP Message integrity:</dt><dd>The digest mechanism described here does not cover the full HTTP message nor its semantic, as representation metadata are not included in the checksum.</dd><dt>Header field integrity:</dt><dd>The digest mechanisms described here cover only representation and selected representation data, and do not protect the integrity of associated representation metadata or other message header fields.</dd><dt>Authentication:</dt><dd>The digest mechanisms described here are not meant to support authentication of the source of a digest or of a message or anything else. These mechanisms, therefore, are not a sufficient defense against many kinds of malicious attacks.</dd><dt>Privacy:</dt><dd>Digest mechanisms do not provide message privacy.</dd><dt>Authorization:</dt><dd>The digest mechanisms described here are not meant to support authorization or other kinds of access controls.</dd></dl></div></section><section id="notational-conventions"><h3 id="rfc.section.1.4"><a href="#rfc.section.1.4">1.4.</a> <a href="#notational-conventions">Notational Conventions</a></h3><div id="rfc.section.1.4.p.1"><p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in BCP 14 (<a href="#RFC2119"><cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a> and <a href="#RFC8174"><cite title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">[RFC8174]</cite></a>) when, and only when, they appear in all capitals, as shown here.</p></div><div id="rfc.section.1.4.p.2"><p>This document uses the Augmented BNF defined in <a href="#RFC5234"><cite title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</cite></a> and updated by <a href="#RFC7405"><cite title="Case-Sensitive String Support in ABNF">[RFC7405]</cite></a> along with the “#rule” extension defined in Section 7 of <a href="#RFC7230"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">[RFC7230]</cite></a>.</p></div><div id="rfc.section.1.4.p.3"><p>The definitions “representation”, “selected representation”, “representation data”, “representation metadata” and “payload body” in this document are to be interpreted as described in <a href="#RFC7230"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">[RFC7230]</cite></a> and <a href="#RFC7231"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a>.</p></div></section></section><section id="resource-representation"><h2 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#resource-representation">Resource representation and representation-data</a></h2><div id="rfc.section.2.p.1" class="avoidbreakafter"><p>To avoid inconsistencies, an integrity mechanism for HTTP messages should decouple the checksum calculation:</p></div><div id="rfc.section.2.p.2"><ul><li>from the payload body - which may be altered by mechanism like Range Requests <a href="#RFC7233"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Range Requests">[RFC7233]</cite></a> or the method (eg. HEAD);</li><li>and from the message body - which depends on <span class="tt">Transfer-Encoding</span> and whatever tranformations the intermediaries may apply.</li></ul></div><div id="rfc.section.2.p.3"><p>The following examples show how representation metadata, payload tranformations and method impacts on the message and payload body.</p></div><div id="rfc.section.2.p.4"><p>Here is a gzip-compressed json object</p></div><div id="rfc.figure.u.1"><div><pre>
Request:

    PUT /entries/1234 HTTP/1.1
    Content-Type: application/json
    Content-Encoding: gzip

    H4sIAItWyFwC/6tWSlSyUlAypANQqgUAREcqfG0AAAA=

</pre></div></div><div id="rfc.section.2.p.5"><p>Now the same payload body conveys a malformed json object.</p></div><div id="rfc.figure.u.2"><div><pre>
Request:

    PUT /entries/1234 HTTP/1.1
    Content-Type: application/json

    H4sIAItWyFwC/6tWSlSyUlAypANQqgUAREcqfG0AAAA=

</pre></div></div><div id="rfc.section.2.p.6"><p>A Range-Request alters the payload body, conveying a partial representation.</p></div><div id="rfc.figure.u.3"><div><pre>
Request:

    GET /entries/1234 HTTP/1.1
    Range: bytes=1-7

Response:

    HTTP/1.1 206 Partial Content
    Content-Encoding: gzip
    Content-Type: application/json
    Content-Range: bytes=1-7

    iwgAla3RXA==
</pre></div></div><div id="rfc.section.2.p.7"><p>Now the method too alters the payload body.</p></div><div id="rfc.figure.u.4"><div><pre>
Request:

    HEAD /entries/1234 HTTP/1.1
    Accept: application/json
    Accept-Encoding: gzip

Response:

    HTTP/1.1 200 OK
    Content-Type: application/json
    Content-Encoding: gzip

</pre></div></div></section><section id="algorithms"><h2 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#algorithms">Digest Algorithm values</a></h2><div id="rfc.section.3.p.1"><p>Digest algorithm values are used to indicate a specific digest computation. For some algorithms, one or more parameters may be supplied.</p></div><div id="rfc.figure.u.5"><div><pre>
      digest-algorithm = token
</pre></div></div><div id="rfc.section.3.p.2"><p>The BNF for “parameter” is as is used in <a href="#RFC7230"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">[RFC7230]</cite></a>. All digest-algorithm values are case-insensitive.</p></div><div id="rfc.section.3.p.3"><p>The Internet Assigned Numbers Authority (IANA) acts as a registry for digest-algorithm values. The registry contains the following tokens.</p></div><div id="rfc.section.3.p.4"><dl class="compact"><dt>SHA-256:</dt><dd><ul><li>Description: The SHA-256 algorithm <a href="#FIPS180-3"><cite title="NIST FIPS 180-3, Secure Hash Standard">[FIPS180-3]</cite></a>. The output of this algorithm is encoded using the base64 encoding <a href="#RFC4648"><cite title="The Base16, Base32, and Base64 Data Encodings">[RFC4648]</cite></a>.</li><li>Reference: <a href="#FIPS180-3"><cite title="NIST FIPS 180-3, Secure Hash Standard">[FIPS180-3]</cite></a>, <a href="#RFC4648"><cite title="The Base16, Base32, and Base64 Data Encodings">[RFC4648]</cite></a>, this document.</li><li>Status: standard</li></ul> </dd><dt>SHA-512:</dt><dd><ul><li>Description: The SHA-512 algorithm <a href="#FIPS180-3"><cite title="NIST FIPS 180-3, Secure Hash Standard">[FIPS180-3]</cite></a>. The output of this algorithm is encoded using the base64 encoding <a href="#RFC4648"><cite title="The Base16, Base32, and Base64 Data Encodings">[RFC4648]</cite></a>.</li><li>Reference: <a href="#FIPS180-3"><cite title="NIST FIPS 180-3, Secure Hash Standard">[FIPS180-3]</cite></a>, <a href="#RFC4648"><cite title="The Base16, Base32, and Base64 Data Encodings">[RFC4648]</cite></a>, this document.</li><li>Status: standard</li></ul> </dd><dt>MD5:</dt><dd><ul><li>Description: The MD5 algorithm, as specified in <a href="#RFC1321"><cite title="The MD5 Message-Digest Algorithm">[RFC1321]</cite></a>. The output of this algorithm is encoded using the base64 encoding <a href="#RFC4648"><cite title="The Base16, Base32, and Base64 Data Encodings">[RFC4648]</cite></a>. The MD5 algorithm MUST NOT be used as it’s now vulnerable to collision attacks <a href="#CMU-836068"><cite title="MD5 Vulnerable to collision attacks">[CMU-836068]</cite></a>.</li><li>Reference: <a href="#RFC1321"><cite title="The MD5 Message-Digest Algorithm">[RFC1321]</cite></a>, <a href="#RFC4648"><cite title="The Base16, Base32, and Base64 Data Encodings">[RFC4648]</cite></a>, this document.</li><li>Status: deprecated</li></ul> </dd><dt>SHA:</dt><dd><ul><li>Description: The SHA-1 algorithm <a href="#FIPS180-1"><cite title="NIST FIPS 180-1, Secure Hash Standard">[FIPS180-1]</cite></a>. The output of this algorithm is encoded using the base64 encoding <a href="#RFC4648"><cite title="The Base16, Base32, and Base64 Data Encodings">[RFC4648]</cite></a>. The SHA algorithm is NOT RECOMMENDED as it’s now vulnerable to collision attacks <a href="#IACR-2019-459"><cite title="From Collisions to Chosen-Prefix Collisions Application to Full SHA-1">[IACR-2019-459]</cite></a>.</li><li>Reference: <a href="#FIPS180-3"><cite title="NIST FIPS 180-3, Secure Hash Standard">[FIPS180-3]</cite></a>, <a href="#RFC4648"><cite title="The Base16, Base32, and Base64 Data Encodings">[RFC4648]</cite></a>, this document.</li><li>Status: obsoleted</li></ul> </dd><dt>UNIXsum:</dt><dd><ul><li>Description: The algorithm computed by the UNIX “sum” command, as defined by the Single UNIX Specification, Version 2 <a href="#UNIX"><cite title="The Single UNIX Specification, Version 2 - 6 Vol Set for UNIX 98">[UNIX]</cite></a>. The output of this algorithm is an ASCII decimal-digit string representing the 16-bit checksum, which is the first word of the output of the UNIX “sum” command.</li><li>Reference: <a href="#UNIX"><cite title="The Single UNIX Specification, Version 2 - 6 Vol Set for UNIX 98">[UNIX]</cite></a>, this document.</li><li>Status: standard</li></ul> </dd><dt>UNIXcksum:</dt><dd><ul><li>Description: The algorithm computed by the UNIX “cksum” command, as defined by the Single UNIX Specification, Version 2 <a href="#UNIX"><cite title="The Single UNIX Specification, Version 2 - 6 Vol Set for UNIX 98">[UNIX]</cite></a>. The output of this algorithm is an ASCII digit string representing the 32-bit CRC, which is the first word of the output of the UNIX “cksum” command.</li><li>Reference: <a href="#UNIX"><cite title="The Single UNIX Specification, Version 2 - 6 Vol Set for UNIX 98">[UNIX]</cite></a>, this document.</li><li>Status: standard</li></ul> </dd></dl></div><div id="rfc.section.3.p.5" class="avoidbreakafter"><p>To allow sender and recipient to provide a checksum which is independent from <span class="tt">Content-Encoding</span>, the following additional algorithms are defined:</p></div><div id="rfc.section.3.p.6"><dl class="compact"><dt>ID-SHA-512:</dt><dd><ul><li>Description: The sha-512 digest of the representation-data of the resource when no content coding is applied (eg. <span class="tt">Content-Encoding: identity</span>)</li><li>Reference: <a href="#FIPS180-3"><cite title="NIST FIPS 180-3, Secure Hash Standard">[FIPS180-3]</cite></a>, <a href="#RFC4648"><cite title="The Base16, Base32, and Base64 Data Encodings">[RFC4648]</cite></a>, this document.</li><li>Status: standard</li></ul> </dd><dt>ID-SHA-256:</dt><dd><ul><li>Description: The sha-256 digest of the representation-data of the resource when no content coding is applied (eg. <span class="tt">Content-Encoding: identity</span>)</li><li>Reference: <a href="#FIPS180-3"><cite title="NIST FIPS 180-3, Secure Hash Standard">[FIPS180-3]</cite></a>, <a href="#RFC4648"><cite title="The Base16, Base32, and Base64 Data Encodings">[RFC4648]</cite></a>, this document.</li><li>Status: standard</li></ul> </dd></dl></div><div id="rfc.section.3.p.7"><p>If other digest-algorithm values are defined, the associated encoding MUST either be represented as a quoted string, or MUST NOT include “;” or “,” in the character sets used for the encoding.</p></div><section id="representation-digest"><h3 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> <a href="#representation-digest">Representation digest</a></h3><div id="rfc.section.3.1.p.1"><p>A representation digest is the value of the output of a digest algorithm, together with an indication of the algorithm used (and any parameters).</p></div><div id="rfc.figure.u.6"><div><pre>
    representation-data-digest = digest-algorithm "="
                            &lt;encoded digest output&gt;
</pre></div></div><div id="rfc.section.3.1.p.2" class="avoidbreakafter"><p>As explained in <a href="#resource-representation" title="Resource representation and representation-data">Section 2</a> the digest is computed on the entire selected <span class="tt">representation data</span> of the resource defined in <a href="#RFC7231"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a>:</p></div><div id="rfc.figure.u.7"><div><pre>
  representation-data := Content-Encoding( Content-Type( bits ) )
</pre></div></div><div id="rfc.section.3.1.p.3"><p>The encoded digest output uses the encoding format defined for the specific digest-algorithm.</p></div><section id="digest-algorithm-encoding-examples"><h4 id="rfc.section.3.1.1"><a href="#rfc.section.3.1.1">3.1.1.</a> <a href="#digest-algorithm-encoding-examples">digest-algorithm encoding examples</a></h4><div id="rfc.section.3.1.1.p.1"><p>The <span class="tt">sha-256</span> digest-algorithm uses base64 encoding. Note that digest-algoritm values are case insensitive.</p></div><div id="rfc.figure.u.8"><div><pre>
sha-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=
</pre></div></div><div id="rfc.section.3.1.1.p.2"><p>The “UNIXsum” digest-algorithm uses ASCII string of decimal digits.</p></div><div id="rfc.figure.u.9"><div><pre>
UNIXsum=30637
</pre></div></div></section></section></section><section id="header-field-specifications"><h2 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#header-field-specifications">Header Field Specifications</a></h2><div id="rfc.section.4.p.1"><p>The following headers are defined</p></div><section id="want-digest-header"><h3 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> <a href="#want-digest-header">Want-Digest</a></h3><div id="rfc.section.4.1.p.1"><p>The Want-Digest message header field indicates the sender’s desire to receive a representation digest on messages associated with the Request- URI and representation metadata.</p></div><div id="rfc.figure.u.10"><div><pre>
Want-Digest = "Want-Digest" ":" OWS 1#want-digest-value
want-digest-value = digest-algorithm [ ";" "q" "=" qvalue]
qvalue = ( "0"  [ "."  0*1DIGIT ] ) /  ( "1"  [ "."  0*1( "0" ) ] )
</pre></div></div><div id="rfc.section.4.1.p.2"><p>If a digest-algorithm is not accompanied by a qvalue, it is treated as if its associated qvalue were 1.0.</p></div><div id="rfc.section.4.1.p.3"><p>The sender is willing to accept a digest-algorithm if and only if it is listed in a Want-Digest header field of a message, and its qvalue is non-zero.</p></div><div id="rfc.section.4.1.p.4"><p>If multiple acceptable digest-algorithm values are given, the sender’s preferred digest-algorithm is the one (or ones) with the highest qvalue.</p></div><div id="rfc.section.4.1.p.5"><p>Two examples of its use are</p></div><div id="rfc.figure.u.11"><div><pre>
   Want-Digest: sha-256
   Want-Digest: SHA-512;q=0.3, sha-256;q=1, md5;q=0
</pre></div></div></section><section id="digest-header"><h3 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> <a href="#digest-header">Digest</a></h3><div id="rfc.section.4.2.p.1"><p>The Digest header field provides a digest of the representation data.</p></div><div id="rfc.figure.u.12"><div><pre>
      Digest = "Digest" ":" OWS 1#representation-data-digest
</pre></div></div><div id="rfc.section.4.2.p.2" class="avoidbreakafter"><p><span class="tt">Representation data</span> might be:</p></div><div id="rfc.section.4.2.p.3"><ul><li>fully contained in the message body,</li><li>partially-contained in the message body,</li><li>or not at all contained in the message body.</li></ul></div><div id="rfc.section.4.2.p.4"><p>The resource is specified by the effective Request-URI and any cache-validator contained in the message.</p></div><div id="rfc.section.4.2.p.5"><p>For example, in a response to a HEAD request, the digest is calculated using the representation data that would have been enclosed in the payload body if the same request had been a GET.</p></div><div id="rfc.section.4.2.p.6"><p>Digest can be used in requests too. Returned value depends on the representation metadata header fields.</p></div><div id="rfc.section.4.2.p.7"><p>A Digest header field MAY contain multiple representation-data-digest values. This could be useful for responses expected to reside in caches shared by users with different browsers, for example.</p></div><div id="rfc.section.4.2.p.8"><p>A recipient MAY ignore any or all of the representation-data-digests in a Digest header field. This allows the recipient to chose which digest-algorithm(s) to use for validation instead of verifying every received representation-data-digest.</p></div><div id="rfc.section.4.2.p.9"><p>A sender MAY send a representation-data-digest using a digest-algorithm without knowing whether the recipient supports the digest-algorithm, or even knowing that the recipient will ignore it.</p></div><div id="rfc.section.4.2.p.10"><p>Two examples of its use are</p></div><div id="rfc.figure.u.13"><div><pre>
  Digest: id-sha-512=WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwE\nmTHWXvJwew==
  Digest: sha-256=4REjxQ4yrqUVicfSKYNO/cF9zNj5ANbzgDZt3/h3Qxo=, id-sha-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=
</pre></div></div><div id="rfc.section.4.2.p.11"><p>…</p></div></section></section><section id="deprecate-negotiation-of-content-md5"><h2 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#deprecate-negotiation-of-content-md5">Deprecate Negotiation of Content-MD5</a></h2><div id="rfc.section.5.p.1"><p>This RFC deprecates the negotiation of Content-MD5 as it has been obsoleted by <a href="#RFC7231"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content">[RFC7231]</cite></a></p></div></section><section id="broken-cryptographic-algorithms"><h2 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#broken-cryptographic-algorithms">Broken cryptographic algorithms</a></h2><div id="rfc.section.6.p.1"><p>The MD5 algorithm MUST NOT be used as it’s now vulnerable to collision attacks <a href="#CMU-836068"><cite title="MD5 Vulnerable to collision attacks">[CMU-836068]</cite></a>.</p></div><div id="rfc.section.6.p.2"><p>The SHA algorithm is NOT RECOMMENDED as it’s now vulnerable to collision attacks <a href="#IACR-2019-459"><cite title="From Collisions to Chosen-Prefix Collisions Application to Full SHA-1">[IACR-2019-459]</cite></a>.</p></div></section><section id="examples"><h2 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#examples">Examples</a></h2><section id="unsolicited-digest-response"><h3 id="rfc.section.7.1"><a href="#rfc.section.7.1">7.1.</a> <a href="#unsolicited-digest-response">Unsolicited Digest response</a></h3><section id="representation-data-is-fully-contained-in-the-payload"><h4 id="rfc.section.7.1.1"><a href="#rfc.section.7.1.1">7.1.1.</a> <a href="#representation-data-is-fully-contained-in-the-payload">Representation data is fully contained in the payload</a></h4><div id="rfc.figure.u.14"><div><pre>
Request:

  GET /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  Content-Encoding: identity
  Digest: sha-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=

  {"hello": "world"}
</pre></div></div></section><section id="representation-data-is-not-contained-in-the-payload"><h4 id="rfc.section.7.1.2"><a href="#rfc.section.7.1.2">7.1.2.</a> <a href="#representation-data-is-not-contained-in-the-payload">Representation data is not contained in the payload</a></h4><div id="rfc.section.7.1.2.p.1"><p>As there is no content coding applied, the <span class="tt">sha-256</span> and the <span class="tt">id-sha-256</span> digest-values are the same.</p></div><div id="rfc.figure.u.15"><div><pre>
Request:

  HEAD /items/123

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  Content-Encoding: identity
  Digest: id-sha-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=

</pre></div></div></section><section id="representation-data-is-partially-contained-in-the-payload-ie-range-request"><h4 id="rfc.section.7.1.3"><a href="#rfc.section.7.1.3">7.1.3.</a> <a href="#representation-data-is-partially-contained-in-the-payload-ie-range-request">Representation data is partially contained in the payload i.e. range request</a></h4><div id="rfc.figure.u.16"><div><pre>
Request:

  GET /items/123
  Range: bytes=1-7

Response:

  HTTP/1.1 206 Partial Content
  Content-Type: application/json
  Content-Encoding: identity
  Content-Range: bytes 1-7/18
  Digest: sha-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=

  "hello"

</pre></div></div></section><section id="digest-in-both-request-and-response-returned-value-depends-on-representation-metadata"><h4 id="rfc.section.7.1.4"><a href="#rfc.section.7.1.4">7.1.4.</a> <a href="#digest-in-both-request-and-response-returned-value-depends-on-representation-metadata">Digest in both Request and Response. Returned value depends on representation metadata</a></h4><div id="rfc.section.7.1.4.p.1"><p>Digest can be used in requests too. Returned value depends on the representation metadata header fields.</p></div><div id="rfc.figure.u.17"><div><pre>
Request:

  PUT /items/123
  Content-Type: application/json
  Content-Encoding: identity
  Accept-Encoding: br
  Digest: sha-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=

  {"hello": "world"}

Response:

  Content-Type: application/json
  Content-Encoding: br
  Digest: sha-256=4REjxQ4yrqUVicfSKYNO/cF9zNj5ANbzgDZt3/h3Qxo=

  iwiAeyJoZWxsbyI6ICJ3b3JsZCJ9Aw==

</pre></div></div></section><section id="digest-in-both-request-and-response-response-uses-id-sha-256"><h4 id="rfc.section.7.1.5"><a href="#rfc.section.7.1.5">7.1.5.</a> <a href="#digest-in-both-request-and-response-response-uses-id-sha-256">Digest in both Request and Response. Response uses id-sha-256.</a></h4><div id="rfc.section.7.1.5.p.1" class="avoidbreakafter"><p>The response contains two digest values:</p></div><div id="rfc.section.7.1.5.p.2"><ul><li>one with no content coding applied, which in this case accidentally matches the unencoded digest-value sent in the request;</li><li>one taking into account the <span class="tt">Content-Encoding</span>.</li></ul></div><div id="rfc.figure.u.18"><div><pre>
Request:

  PUT /items/123
  Content-Type: application/json
  Content-Encoding: identity
  Accept-Encoding: br
  Digest: sha-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=

  {"hello": "world"}

Response:

  Content-Type: application/json
  Content-Encoding: br
  Digest: sha-256=4REjxQ4yrqUVicfSKYNO/cF9zNj5ANbzgDZt3/h3Qxo=, id-sha-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=

  iwiAeyJoZWxsbyI6ICJ3b3JsZCJ9Aw==

</pre></div></div></section></section><section id="want-digest-solicited-digest-responses"><h3 id="rfc.section.7.2"><a href="#rfc.section.7.2">7.2.</a> <a href="#want-digest-solicited-digest-responses">Want-Digest solicited digest responses</a></h3><section id="client-request-data-is-fully-contained-in-the-payload"><h4 id="rfc.section.7.2.1"><a href="#rfc.section.7.2.1">7.2.1.</a> <a href="#client-request-data-is-fully-contained-in-the-payload">Client request data is fully contained in the payload</a></h4><div id="rfc.section.7.2.1.p.1"><p>The client requests a digest, preferring sha. The server is free to reply with sha-256 anyway.</p></div><div id="rfc.figure.u.19"><div><pre>
Request:

  GET /items/123
  Want-Digest: sha-256;q=0.3, sha;q=1

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  Content-Encoding: identity
  Digest: sha-256=X48E9qOokqqrvdts8nOJRJN3OWDUoyWxBf7kbu9DBPE=

  {"hello": "world"}
</pre></div></div></section><section id="a-client-requests-an-unsupported-digest-the-server-may-reply-with-an-unsupported-digest"><h4 id="rfc.section.7.2.2"><a href="#rfc.section.7.2.2">7.2.2.</a> <a href="#a-client-requests-an-unsupported-digest-the-server-may-reply-with-an-unsupported-digest">A client requests an unsupported Digest, the server MAY reply with an unsupported digest</a></h4><div id="rfc.section.7.2.2.p.1"><p>The client requests a sha digest only. The server is currently free to reply with a Digest containing an unsupported algorithm</p></div><div id="rfc.figure.u.20"><div><pre>
Request:

  GET /items/123
  Want-Digest: sha;q=1

Response:

  HTTP/1.1 200 Ok
  Content-Type: application/json
  Content-Encoding: identity
  Digest: id-sha-512=WZDPaVn/7XgHaAy8pmojAkGWoRx2UFChF41A2svX+TaPm+AbwAgBWnrIiYllu7BNNyealdVLvRwE\nmTHWXvJwew==

  {"hello": "world"}
</pre></div></div></section><section id="a-client-requests-an-unsupported-digest-the-server-may-reply-with-a-400"><h4 id="rfc.section.7.2.3"><a href="#rfc.section.7.2.3">7.2.3.</a> <a href="#a-client-requests-an-unsupported-digest-the-server-may-reply-with-a-400">A client requests an unsupported Digest, the server MAY reply with a 400</a></h4><div id="rfc.section.7.2.3.p.1"><p>The client requests a sha Digest, the server advises for sha-256 and sha-512</p></div><div id="rfc.figure.u.21"><div><pre>
Request:

  GET /items/123
  Want-Digest: sha;q=1

Response:

  HTTP/1.1 400 Bad Request
  Want-Digest: sha-256, sha-512
</pre></div></div><div id="rfc.section.7.2.3.p.2"><p>…</p></div></section></section></section><section id="security-considerations"><h2 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#security-considerations">Security Considerations</a></h2><section id="digest-does-not-protect-the-full-http-message"><h3 id="rfc.section.8.1"><a href="#rfc.section.8.1">8.1.</a> <a href="#digest-does-not-protect-the-full-http-message">Digest does not protect the full HTTP message</a></h3><div id="rfc.section.8.1.p.1"><p>This document specifies a data integrity mechanism that protects HTTP <span class="tt">representation data</span>, but not HTTP <span class="tt">representation metadata</span> header fields, from certain kinds of accidental corruption.</p></div><div id="rfc.section.8.1.p.2"><p>While it is not intended as general protection against malicious tampering with HTTP messages, this goal can be achieved using <span class="tt">Digest</span> together with a transport-layer security mechanism and digital signatures.</p></div></section><section id="broken-cryptographic-algorithms-1"><h3 id="rfc.section.8.2"><a href="#rfc.section.8.2">8.2.</a> <a href="#broken-cryptographic-algorithms-1">Broken cryptographic algorithms</a></h3><div id="rfc.section.8.2.p.1"><p>Cryptogrphic alorithms are intended to provide a proof of integrity suited towards cryptographic constructions such as signatures.</p></div><div id="rfc.section.8.2.p.2"><p>However, these rely on collision-resistance for their security proofs <a href="#CMU-836068"><cite title="MD5 Vulnerable to collision attacks">[CMU-836068]</cite></a>. The MD5 and SHA-1 algorithms are vulnerable to collisions attacks, so MD5 MUST NOT be used and SHA-1 is NOT RECOMMENDED.</p></div></section><section id="digest-for-end-to-end-integrity"><h3 id="rfc.section.8.3"><a href="#rfc.section.8.3">8.3.</a> <a href="#digest-for-end-to-end-integrity">Digest for end-to-end integrity</a></h3><div id="rfc.section.8.3.p.1"><p><span class="tt">Digest</span> alone does not provide end-to-end integrity of HTTP messages over multiple hops, as it just covers the <span class="tt">representation data</span> and not the <span class="tt">representation metadata</span>.</p></div><div id="rfc.section.8.3.p.2"><p>Besides, it allows to protect <span class="tt">representation data</span> from buggy manipulation, buggy compression, etc.</p></div><div id="rfc.section.8.3.p.3"><p>Moreover identity digest algorithms (eg. ID-SHA-256 and ID-SHA-512) allow piecing together a resource from different sources (e.g. different servers that perhaps apply different content codings) enabling the user-agent to detect that the application-layer tasks completed properly, before handing off to say the HTML parser, video player etc.</p></div><div id="rfc.section.8.3.p.4"><p>Even a simple mechanism for end-to-end validation is thus valuable.</p></div></section><section id="usage-in-signatures"><h3 id="rfc.section.8.4"><a href="#rfc.section.8.4">8.4.</a> <a href="#usage-in-signatures">Usage in signatures</a></h3><div id="rfc.section.8.4.p.1"><p>Digital signatures are widely used together with checksums to provide the certain identification of the origin of a message <a href="#NIST800-32"><cite title="Introduction to Public Key Technology and the Federal PKI Infrastructure">[NIST800-32]</cite></a>.</p></div><div id="rfc.section.8.4.p.2"><p>It’s important to note that, being the <span class="tt">Digest</span> header field an hash of a resource representation, signing only the <span class="tt">Digest</span> header field, without all the <span class="tt">representation metatada</span> (eg. the values of <span class="tt">Content-Type</span> and <span class="tt">Content-Encoding</span>) may expose the communication to tampering.</p></div><div id="rfc.section.8.4.p.3"><p><span class="tt">Digest</span> SHOULD always be used over a connection which provides integrity at transport layer that protects HTTP header fields.</p></div><div id="rfc.section.8.4.p.4"><p>A <span class="tt">Digest</span> header field using NOT RECOMMENDED digest-algorithms SHOULD NOT be used in signatures.</p></div></section><section id="message-truncation"><h3 id="rfc.section.8.5"><a href="#rfc.section.8.5">8.5.</a> <a href="#message-truncation">Message Truncation</a></h3><div id="rfc.section.8.5.p.1"><p>…</p></div></section><section id="algorithm-agility"><h3 id="rfc.section.8.6"><a href="#rfc.section.8.6">8.6.</a> <a href="#algorithm-agility">Algorithm Agility</a></h3><div id="rfc.section.8.6.p.1"><p>…</p></div></section></section><section id="iana-considerations"><h2 id="rfc.section.9"><a href="#rfc.section.9">9.</a> <a href="#iana-considerations">IANA Considerations</a></h2><section id="establish-the-http-digest-algorithm-values"><h3 id="rfc.section.9.1"><a href="#rfc.section.9.1">9.1.</a> <a href="#establish-the-http-digest-algorithm-values">Establish the HTTP Digest Algorithm Values</a></h3><div id="rfc.section.9.1.p.1"><p>This memo sets this spec to be the establishing document for the <a href="https://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml">HTTP Digest Algorithm Values</a></p></div></section><section id="the-status-field-in-the-http-digest-algorithm-values"><h3 id="rfc.section.9.2"><a href="#rfc.section.9.2">9.2.</a> <a href="#the-status-field-in-the-http-digest-algorithm-values">The “status” field in the HTTP Digest Algorithm Values</a></h3><div id="rfc.section.9.2.p.1"><p>This memo adds the field “Status” to the <a href="https://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml">HTTP Digest Algorithm Values</a> registry. The allowed values for the “Status” fields are described below.</p></div><div id="rfc.section.9.2.p.2"><dl class="compact"><dt>Status</dt><dd>Specify “standard”, “experimental”, “historic”, “obsoleted”, or “deprecated” according to the type and status of the primary document in which the algorithm is defined.</dd></dl></div></section><section id="iana-MD5"><h3 id="rfc.section.9.3"><a href="#rfc.section.9.3">9.3.</a> <a href="#iana-MD5">Deprecate “MD5” Digest Algorithm</a></h3><div id="rfc.section.9.3.p.1" class="avoidbreakafter"><p>This memo updates the “MD5” digest algorithm in the <a href="https://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml">HTTP Digest Algorithm Values</a> registry:</p></div><div id="rfc.section.9.3.p.2"><ul><li>Digest Algorithm: MD5</li><li>Description: As specified in <a href="#algorithms" title="Digest Algorithm values">Section 3</a>.</li><li>Status: As specified in <a href="#algorithms" title="Digest Algorithm values">Section 3</a>.</li></ul></div></section><section id="iana-SHA"><h3 id="rfc.section.9.4"><a href="#rfc.section.9.4">9.4.</a> <a href="#iana-SHA">Obsolete “SHA” Digest Algorithm</a></h3><div id="rfc.section.9.4.p.1" class="avoidbreakafter"><p>This memo updates the “SHA” digest algorithm in the <a href="https://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml">HTTP Digest Algorithm Values</a> registry:</p></div><div id="rfc.section.9.4.p.2"><ul><li>Digest Algorithm: SHA</li><li>Description: As specified in <a href="#algorithms" title="Digest Algorithm values">Section 3</a>.</li><li>Status: As specified in <a href="#algorithms" title="Digest Algorithm values">Section 3</a>.</li></ul></div></section><section id="iana-ID-SHA-256"><h3 id="rfc.section.9.5"><a href="#rfc.section.9.5">9.5.</a> <a href="#iana-ID-SHA-256">The “ID-SHA-256” Digest Algorithm</a></h3><div id="rfc.section.9.5.p.1" class="avoidbreakafter"><p>This memo registers the “ID-SHA-256” digest algorithm in the <a href="https://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml">HTTP Digest Algorithm Values</a> registry:</p></div><div id="rfc.section.9.5.p.2"><ul><li>Digest Algorithm: ID-SHA-256</li><li>Description: As specified in <a href="#algorithms" title="Digest Algorithm values">Section 3</a>.</li><li>Status: As specified in <a href="#algorithms" title="Digest Algorithm values">Section 3</a>.</li></ul></div></section><section id="iana-ID-SHA-512"><h3 id="rfc.section.9.6"><a href="#rfc.section.9.6">9.6.</a> <a href="#iana-ID-SHA-512">The “ID-SHA-512” Digest Algorithm</a></h3><div id="rfc.section.9.6.p.1" class="avoidbreakafter"><p>This memo registers the “ID-SHA-512” digest algorithm in the <a href="https://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml">HTTP Digest Algorithm Values</a> registry:</p></div><div id="rfc.section.9.6.p.2"><ul><li>Digest Algorithm: ID-SHA-512</li><li>Description: As specified in <a href="#algorithms" title="Digest Algorithm values">Section 3</a>.</li><li>Status: As specified in <a href="#algorithms" title="Digest Algorithm values">Section 3</a>.</li></ul></div></section><section id="changes-compared-to-rfc5843"><h3 id="rfc.section.9.7"><a href="#rfc.section.9.7">9.7.</a> <a href="#changes-compared-to-rfc5843">Changes compared to RFC5843</a></h3><div id="rfc.section.9.7.p.1"><p>The status of “MD5” has been updated to “deprecated”, and its description states that this algoritm MUST NOT be used.</p></div><div id="rfc.section.9.7.p.2"><p>The status of “SHA” has been updated to “obsoleted”, and its description states that this algorithm is NOT RECOMMENDED.</p></div><div id="rfc.section.9.7.p.3"><p>The status for all other algorithms have been updated to “standard”.</p></div><div id="rfc.section.9.7.p.4"><p>The “ID-SHA-256” and “ID-SHA-512” algorithms have been added to the registry.</p></div></section><section id="want-digest-header-field-registration"><h3 id="rfc.section.9.8"><a href="#rfc.section.9.8">9.8.</a> <a href="#want-digest-header-field-registration">Want-Digest Header Field Registration</a></h3><div id="rfc.section.9.8.p.1"><p>This section registers the <span class="tt">Want-Digest</span> header field in the “Permanent Message Header Field Names” registry (<a href="#RFC3864"><cite title="Registration Procedures for Message Header Fields">[RFC3864]</cite></a>).</p></div><div id="rfc.section.9.8.p.2"><p>Header field name: <span class="tt">Want-Digest</span></p></div><div id="rfc.section.9.8.p.3"><p>Applicable protocol: http</p></div><div id="rfc.section.9.8.p.4"><p>Status: standard</p></div><div id="rfc.section.9.8.p.5"><p>Author/Change controller: IETF</p></div><div id="rfc.section.9.8.p.6"><p>Specification document(s): <a href="#want-digest-header" title="Want-Digest">Section 4.1</a> of this document</p></div></section><section id="digest-header-field-registration"><h3 id="rfc.section.9.9"><a href="#rfc.section.9.9">9.9.</a> <a href="#digest-header-field-registration">Digest Header Field Registration</a></h3><div id="rfc.section.9.9.p.1"><p>This section registers the <span class="tt">Digest</span> header field in the “Permanent Message Header Field Names” registry (<a href="#RFC3864"><cite title="Registration Procedures for Message Header Fields">[RFC3864]</cite></a>).</p></div><div id="rfc.section.9.9.p.2"><p>Header field name: <span class="tt">Digest</span></p></div><div id="rfc.section.9.9.p.3"><p>Applicable protocol: http</p></div><div id="rfc.section.9.9.p.4"><p>Status: standard</p></div><div id="rfc.section.9.9.p.5"><p>Author/Change controller: IETF</p></div><div id="rfc.section.9.9.p.6"><p>Specification document(s): <a href="#digest-header" title="Digest">Section 4.2</a> of this document</p></div></section></section><section id="rfc.references"><h2 id="rfc.section.10"><a href="#rfc.section.10">10.</a> References</h2><section><div id="rfc.references.1"><h3 id="rfc.section.10.1"><a href="#rfc.section.10.1">10.1.</a> Normative References</h3><dl class="reference"><dt id="CMU-836068">[CMU-836068]</dt><dd>Carnagie Mellon University, Software Engineering Institute, ., “<a href="https://www.kb.cert.org/vuls/id/836068/">MD5 Vulnerable to collision attacks</a>”, December 2008, &lt;<a href="https://www.kb.cert.org/vuls/id/836068/">https://www.kb.cert.org/vuls/id/836068/</a>&gt;.</dd><dt id="FIPS180-1">[FIPS180-1]</dt><dd>Department of Commerce, National Institute of Standards and Technology, U., “<a href="http://csrc.nist.gov/fips/fip180-1.txt">NIST FIPS 180-1, Secure Hash Standard</a>”, April 1995, &lt;<a href="http://csrc.nist.gov/fips/fip180-1.txt">http://csrc.nist.gov/fips/fip180-1.txt</a>&gt;.</dd><dt id="FIPS180-3">[FIPS180-3]</dt><dd>Department of Commerce, National Institute of Standards and Technology, U., “<a href="https://csrc.nist.gov/csrc/media/publications/fips/180/3/archive/2008-10-31/documents/fips180-3_final.pdf">NIST FIPS 180-3, Secure Hash Standard</a>”, October 2008, &lt;<a href="https://csrc.nist.gov/csrc/media/publications/fips/180/3/archive/2008-10-31/documents/fips180-3_final.pdf">https://csrc.nist.gov/csrc/media/publications/fips/180/3/archive/2008-10-31/documents/fips180-3_final.pdf</a>&gt;.</dd><dt id="IACR-2019-459">[IACR-2019-459]</dt><dd>Inria, France; Nanyang Technological University, Singapore; Temasek Laboratories, Singapore, ., “<a href="https://eprint.iacr.org/2019/459.pdf">From Collisions to Chosen-Prefix Collisions Application to Full SHA-1</a>”, May 2019, &lt;<a href="https://eprint.iacr.org/2019/459.pdf">https://eprint.iacr.org/2019/459.pdf</a>&gt;.</dd><dt id="NIST800-32">[NIST800-32]</dt><dd>Department of Commerce, National Institute of Standards and Technology, U., “<a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-32.pdf">Introduction to Public Key Technology and the Federal PKI Infrastructure</a>”, February 2001, &lt;<a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-32.pdf">https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-32.pdf</a>&gt;.</dd><dt id="RFC1321">[RFC1321]</dt><dd>Rivest, R., “<a href="https://tools.ietf.org/html/rfc1321">The MD5 Message-Digest Algorithm</a>”, RFC 1321, <a href="http://dx.doi.org/10.17487/RFC1321">DOI 10.17487/RFC1321</a>, April 1992, &lt;<a href="https://www.rfc-editor.org/info/rfc1321">https://www.rfc-editor.org/info/rfc1321</a>&gt;.</dd><dt id="RFC2119">[RFC2119]</dt><dd>Bradner, S., “<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>”, BCP 14, RFC 2119, <a href="http://dx.doi.org/10.17487/RFC2119">DOI 10.17487/RFC2119</a>, March 1997, &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.</dd><dt id="RFC3230">[RFC3230]</dt><dd>Mogul, J. and A. Van Hoff, “<a href="https://tools.ietf.org/html/rfc3230">Instance Digests in HTTP</a>”, RFC 3230, <a href="http://dx.doi.org/10.17487/RFC3230">DOI 10.17487/RFC3230</a>, January 2002, &lt;<a href="https://www.rfc-editor.org/info/rfc3230">https://www.rfc-editor.org/info/rfc3230</a>&gt;.</dd><dt id="RFC3864">[RFC3864]</dt><dd>Klyne, G., Nottingham, M., and J. Mogul, “<a href="https://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>”, BCP 90, RFC 3864, <a href="http://dx.doi.org/10.17487/RFC3864">DOI 10.17487/RFC3864</a>, September 2004, &lt;<a href="https://www.rfc-editor.org/info/rfc3864">https://www.rfc-editor.org/info/rfc3864</a>&gt;.</dd><dt id="RFC4648">[RFC4648]</dt><dd>Josefsson, S., “<a href="https://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>”, RFC 4648, <a href="http://dx.doi.org/10.17487/RFC4648">DOI 10.17487/RFC4648</a>, October 2006, &lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;.</dd><dt id="RFC5234">[RFC5234]</dt><dd>Crocker, D., Ed. and P. Overell, “<a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>”, STD 68, RFC 5234, <a href="http://dx.doi.org/10.17487/RFC5234">DOI 10.17487/RFC5234</a>, January 2008, &lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;.</dd><dt id="RFC5789">[RFC5789]</dt><dd>Dusseault, L. and J. Snell, “<a href="https://tools.ietf.org/html/rfc5789">PATCH Method for HTTP</a>”, RFC 5789, <a href="http://dx.doi.org/10.17487/RFC5789">DOI 10.17487/RFC5789</a>, March 2010, &lt;<a href="https://www.rfc-editor.org/info/rfc5789">https://www.rfc-editor.org/info/rfc5789</a>&gt;.</dd><dt id="RFC5843">[RFC5843]</dt><dd>Bryan, A., “<a href="https://tools.ietf.org/html/rfc5843">Additional Hash Algorithms for HTTP Instance Digests</a>”, RFC 5843, <a href="http://dx.doi.org/10.17487/RFC5843">DOI 10.17487/RFC5843</a>, April 2010, &lt;<a href="https://www.rfc-editor.org/info/rfc5843">https://www.rfc-editor.org/info/rfc5843</a>&gt;.</dd><dt id="RFC7230">[RFC7230]</dt><dd>Fielding, R., Ed. and J. Reschke, Ed., “<a href="https://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>”, RFC 7230, <a href="http://dx.doi.org/10.17487/RFC7230">DOI 10.17487/RFC7230</a>, June 2014, &lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;.</dd><dt id="RFC7231">[RFC7231]</dt><dd>Fielding, R., Ed. and J. Reschke, Ed., “<a href="https://tools.ietf.org/html/rfc7231">Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</a>”, RFC 7231, <a href="http://dx.doi.org/10.17487/RFC7231">DOI 10.17487/RFC7231</a>, June 2014, &lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;.</dd><dt id="RFC7233">[RFC7233]</dt><dd>Fielding, R., Ed., Lafon, Y., Ed., and J. Reschke, Ed., “<a href="https://tools.ietf.org/html/rfc7233">Hypertext Transfer Protocol (HTTP/1.1): Range Requests</a>”, RFC 7233, <a href="http://dx.doi.org/10.17487/RFC7233">DOI 10.17487/RFC7233</a>, June 2014, &lt;<a href="https://www.rfc-editor.org/info/rfc7233">https://www.rfc-editor.org/info/rfc7233</a>&gt;.</dd><dt id="RFC7405">[RFC7405]</dt><dd>Kyzivat, P., “<a href="https://tools.ietf.org/html/rfc7405">Case-Sensitive String Support in ABNF</a>”, RFC 7405, <a href="http://dx.doi.org/10.17487/RFC7405">DOI 10.17487/RFC7405</a>, December 2014, &lt;<a href="https://www.rfc-editor.org/info/rfc7405">https://www.rfc-editor.org/info/rfc7405</a>&gt;.</dd><dt id="RFC8174">[RFC8174]</dt><dd>Leiba, B., “<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>”, BCP 14, RFC 8174, <a href="http://dx.doi.org/10.17487/RFC8174">DOI 10.17487/RFC8174</a>, May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.</dd><dt id="UNIX">[UNIX]</dt><dd>The Open Group, ., “The Single UNIX Specification, Version 2 - 6 Vol Set for UNIX 98”, February 1997.</dd></dl></div></section><section><div id="rfc.references.2"><h3 id="rfc.section.10.2"><a href="#rfc.section.10.2">10.2.</a> Informative References</h3><dl class="reference"><dt id="RFC2818">[RFC2818]</dt><dd>Rescorla, E., “<a href="https://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>”, RFC 2818, <a href="http://dx.doi.org/10.17487/RFC2818">DOI 10.17487/RFC2818</a>, May 2000, &lt;<a href="https://www.rfc-editor.org/info/rfc2818">https://www.rfc-editor.org/info/rfc2818</a>&gt;.</dd><dt id="RFC7396">[RFC7396]</dt><dd>Hoffman, P. and J. Snell, “<a href="https://tools.ietf.org/html/rfc7396">JSON Merge Patch</a>”, RFC 7396, <a href="http://dx.doi.org/10.17487/RFC7396">DOI 10.17487/RFC7396</a>, October 2014, &lt;<a href="https://www.rfc-editor.org/info/rfc7396">https://www.rfc-editor.org/info/rfc7396</a>&gt;.</dd><dt id="SRI">[SRI]</dt><dd>Akhawe, D., Braun, F., Marier, F., and J. Weinberger, “Subresource Integrity”, June 2016.</dd></dl></div></section></section><section id="change-log"><h2 id="rfc.section.A" class="np"><a href="#rfc.section.A">Appendix A.</a> <a href="#change-log">Change Log</a></h2><div id="rfc.section.A.p.1"><p>RFC EDITOR PLEASE DELETE THIS SECTION.</p></div></section><section id="faq"><h2 id="rfc.section.B"><a href="#rfc.section.B">Appendix B.</a> <a href="#faq">FAQ</a></h2><div id="rfc.section.B.p.1"><ol><li>Why remove all references to content-md5? <br><br> Those were unnecessary to understanding and using this spec.</li><li>Why remove references to instance manipulation? <br><br> Those were unnecessary for correctly using and applying the spec. An example with Range Request is more than enough. This doc uses the term “partial representation” which should group all those cases.</li><li>How to use <span class="tt">Digest</span> with <span class="tt">PATCH</span> method? <br><br> The PATCH verb brings some complexities (eg. about representation metadata header fields, patch document format, …), <ul><li>PATCH entity-headers apply to the patch document and MUST NOT be applied to the target resource, see <a href="#RFC5789"><cite title="PATCH Method for HTTP">[RFC5789]</cite></a>, Section 2.</li><li>servers shouldn’t assume PATCH semantics for generic media types like “application/json” but should instead use a proper content-type, eg <a href="#RFC7396"><cite title="JSON Merge Patch">[RFC7396]</cite></a></li><li>a <span class="tt">200 OK</span> response to a PATCH request would contain the digest of the patched item, and the etag of the new object. This behavior - tighly coupled to the application logic - gives the client low probability of guessing the actual outcome of this operation (eg. concurrent changes, …)</li></ul></li><li>Why remove references to delta-encoding? <br><br> Unnecessary for a correct implementation of this spec. The revised spec can be nicely adapted to “delta encoding”, but all the references here to delta encoding don’t add anything to this RFC. Another job would be to refresh delta encoding.</li><li>Why remove references to Digest Authentication? <br><br> This RFC seems to me completely unrelated to Digest Authentication but for the word “Digest”.</li><li>What changes in <span class="tt">Want-Digest</span>? <br><br> We allow to use the <span class="tt">Want-Digest</span> in responses to advertise the supported digest-algorithms and the inability to accept requests with unsupported digest-algorithms.</li><li>Does this spec changes supported algorithms? <br><br> This RFC updates <a href="#RFC5843"><cite title="Additional Hash Algorithms for HTTP Instance Digests">[RFC5843]</cite></a> which is still delegated for all algorithms updates, and adds two more algorithms: ID-SHA-256 and ID-SHA-512 which allows to send a checksum of a resource representation with no content codings applied.</li></ol></div></section><section id="acknowledgements"><h2 id="rfc.section.unnumbered-1"><a href="#acknowledgements">Acknowledgements</a></h2><div id="rfc.section.unnumbered-1.p.1"><p>The vast majority of this document is inherited from <a href="#RFC3230"><cite title="Instance Digests in HTTP">[RFC3230]</cite></a>, so thanks to J. Mogul and A. Van Hoff for their great work. The original idea of refreshing this document arose from an interesting discussion with M. Nottingham, J. Yasskin and M. Thomson when reviewing the MICE content coding.</p></div></section><section id="rfc.authors" class="avoidbreakinside"><h2><a href="#rfc.authors">Authors' Addresses</a></h2><address><b>Roberto Polli</b><br>Team Digitale, Italian Government<br>EMail: <a href="mailto:robipolli@gmail.com">robipolli@gmail.com</a></address><address><b>Lucas Pardue</b><br>Cloudflare<br>EMail: <a href="mailto:lucaspardue.24.7@gmail.com">lucaspardue.24.7@gmail.com</a></address></section></body></html>

